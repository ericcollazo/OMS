extends layout

block content
  h2 #{title}
    h3 #{message}
    p Enter stocks to research in the grid below.
    div(ng-app="oms", ng-controller="symbol-controller")
        #Research.input-group
            input.form-control(placeholder="Enter stock symbol...", type="text", ng-model="newSymbol")
            #Action.input-group-btn
            button.btn.btn-sm.btn-success(type="button", ng-click="symbolAdd()") Add To Grid
        table.table.table-bordered
            thead
                tr
                    th Symbol
                    th(align="right") Last Trade Price
                    th(align="right") Δ
                    th(align="right") Δ%
                    th(align="right") Market Cap
                    th(align="right") Volume
                    th H/L/O
                    th Timestamp
                    th Action
            tbody
                tr(ng-repeat="symbol in symbols", ng-class="[{'success': symbol.delta > 0}, {'danger': symbol.delta < 0}]")
                    td {{symbol.name}}
                    td(align="right") {{symbol.price}}
                    td(align="right") {{symbol.delta}}
                    td(align="right") {{symbol.deltap}}
                    td(align="right") {{symbol.marketCap}}
                    td(align="right") {{symbol.volume}}
                    td {{symbol.hlc}}
                    td 
                        span.form-control-static {{symbol.timestamp}}
                    td
                        button.btn.btn-sm.btn-success(type="button", data-toggle="modal", data-target="#tradeModal", data-symbol='{{symbol}}') Trade
                        button.btn.btn-sm.btn-danger(type="button", ng-click="removeSymbol(symbol.name)") Remove

          div.modal.fade(id="tradeModal", tabindex=-1, role="dialog", aria-labelledby="tradeModalLabel")
              div.modal-dialog(role="document")
                  div.modal-content
                      div.modal-header
                          button.close(type="button", data-dismiss="modal", aria-label="Close") 
                              span(aria-hidden="true") &times;
                          div.modal-title(id="tradeModalLabel")
                              h4 Stock Trade
                      div.modal-body
                          p Symbol: {{trade.name}}
                          p Name: {{trade.fullName}}
                          p Last Trade Price: {{trade.price}}
                          div.input-group
                              input.form-control(placeholder="Shares to trade...", type="text", ng-model="tradeShares")
                              div.input-group-btn
                              button.btn.btn-sm.btn-success(type="button", ng-click="buySymbol(trade.name)") Buy
                              button.btn.btn-sm.btn-danger(type="button", ng-click="sellSymbol(trade.name)") Sell
                      div.modal-footer
                          button.btn.btn-default(type="button", data-dismiss="modal") Close

block body_end
  script(type='text/javascript' src='/js/research.js')
